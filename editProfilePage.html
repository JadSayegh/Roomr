<!-- Matthew Beirouti created this document to create a separate page for profile modification -->
<!-- made this by copying everything from living preferences page and pasting it in a new document -->
<!-- with that being said there will be a lot of code that is not necessary. I tried to clean up as much as I could though. -->
<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Roomr</title>

    <!-- Bootstrap -->
     <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>-->

<script type="text/javascript" src="js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="js/jquery.leanModal.min.js"></script>
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
<link type="text/css" rel="stylesheet" href="css/style.css" />
<link href='http://fonts.googleapis.com/css?family=Fredoka+One' rel='stylesheet' type='text/css'>
	<!--Google fonts-->
	<!--<link href="http://fonts.googleapis.com/css?family=Oxygen" rel="stylesheet" type="text/css">-->
    <style type="text/css">
      /* Special class on .container surrounding .navbar, used for positioning it into place. */
      .navbar-wrapper {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        z-index: 20;
        margin-top: 20px;
      }
	 .warning{
				
				
		
	 }  
	 .module {
		
	  	
		float:left; 
		
		
		   			  
	}
	.module2{
		
		float:right;  
		
	}
	 
	.navbar-inverse .navbar-inner {
		background-color : red;
	}   /* Flip around the padding for proper display in narrow viewports */
      .navbar-wrapper .container {
        padding-left: 0;
        padding-right: 0;
      }
      .navbar-wrapper .navbar {
        padding-left: 15px;
        padding-right: 15px;
      }

      .navbar-content
      {
          width:320px;
          padding: 15px;
          padding-bottom:0px;
      }
      .navbar-content:before, .navbar-content:after
      {
          display: table;
          content: "";
          line-height: 0;
      }
      .navbar-nav.navbar-right:last-child {
      margin-right: 15px !important;
      }
	.buttonRight{
	position: absolute;
	left:80%;
	}
	.container1{
	
	margin-left: 10%;
	}
      .navbar-footer 
      {
          background-color:#FFFFFF;
      }
      .navbar-footer-content { padding:15px 15px 15px 15px; }

      .dropdown-menu {
      padding: 0px;
      overflow: hidden;
      }


	.requests { 

	left : 8%;
	}
	
	.bs-example{
		margin: 20px;
	}
body {
    padding-top: 15px;
    background-color: #ffffff;
}
/*REQUIRED*/

.carousel-row {
	margin-left: 5%;
    margin-bottom: 10px;
}

.slide-row {
    padding: 0;
    background-color: #ffffff;
    min-height: 210px;
	min-width: 400px;
	
    border: 1px solid #e7e7e7;
    overflow: hidden;
    height: auto;
    position: relative;
}

.slide-row2 {
    padding: 0;
    background-color: #ffffff;
    min-height: 100px;
	min-width: 400px;
	
    border: 1px solid #e7e7e7;
    overflow: hidden;
    height: auto;
    position: relative;
}


.circle
{
width:100px;
height:100px;
border-radius:100%;
font-size:40px;
color:#fff;
line-height:100px;
text-align:center;
background:#3385FF;
float: left;
margin-left:10px;
margin-top: 10px;
margin-bottom:10px;
display:inline-block;
}

.slide-carousel {
    width: 20%;
	float:left;
 
}


.slide-carousel .carousel-indicators .active {
    margin: 1px;
	
}

.slide-content {
    position: absolute;
    top: 0;
    left: 0%;
    display: block;
	
    width: 80%;
    max-height: 100%;
    padding: 1.5% 2% 2% 2%;
    overflow-y: auto;
}

.slide-content h4 {
    margin-bottom: 3px;
    margin-top: 0;
}

.slide-footer {
    position: absolute;
    bottom: 0;
    left: 20%;
    width: 76%;
    height: 20%;
    margin: 1%;
}

/* Scrollbars */
.slide-content::-webkit-scrollbar {
  width: 5px;
	height:10px;
}
 
.slide-content::-webkit-scrollbar-thumb:vertical {
  margin: 5px;
  background-color: #999;
  -webkit-border-radius: 5px;
}
 
.slide-content::-webkit-scrollbar-button:start:decrement,
.slide-content::-webkit-scrollbar-button:end:increment {
  height: 5px;
  display: block;
}

.customContainer{

	witdh:1000px;
	display: inline-block;
	margin-left: 10%;
	
}	
		
.box{
	float:left;
	padding-left: 20px;
	
	
}

.box2{
	float:right;
	padding-left: 20px;
	
	
}

	
    </style>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <!-- Static navbar -->
     <nav class="navbar navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!--<a class="navbar-brand">Roomr - Living Preferences</a>-->
        </div>
<div class="bs-example">
    <ul class="nav nav-tabs">
        
        <li><a href="livingPreferences.html">Interests</a></li>
		<li><a href = "Profile.php"> My Profile </a></li>
        <li><a href="requests.html">Requests</a></li>
		<li><a href="aboutPage.html">About</a></li>
		<li ><a href="search.html">Search</a></li>
 <div id="navbar" class="navbar-collapse collapse">
         		  
		  <ul class="nav navbar-nav navbar-right">
									
									  <button type="button" class="btn btn-warning navbar-btn" onclick = "editProfile()"><span class="glyphicon glyphicon-edit"></span> Edit Profile</button>
									  <button type="button" class="btn btn-danger navbar-btn" onclick = "signOut()"><span class="glyphicon glyphicon-off"></span> Sign Out</button>
															
				</ul>
		 
        </div><!--/.nav-collapse -->
      </div>
    </ul>
</div>
    </nav>


	
	
	<!-- MATTHEW BEIROUTI ADDITIONS: -->
     <div class="customContainer">
	<div class = "module">
	
	<form id="changePasswordForm" action = >
        <p> Change Password: </p>
       
        <input type = "password" id="oldPassword"> Old Password <br><br>
       
        <input type = "password" id="newPassword"> New Password Confirmation <br><br>
        <input type = "password" id="newPasswordConfirmation"> New Password <br><br>
       
    </form>
	  
    <button type="button" class="btn btn-warning navbar-btn" onclick = "changePassword()"><span class="glyphicon glyphicon-edit"></span> Submit</button>
    <!-- END MATTHEW BEIROUTI ADDITIONS -->
  
  </div>
	
  
  <div class="module2">
	<form id="changeUsernameForm" >
        <p> Change Username: </p>
       
        <input type = "text" id="oldUsername"> Old Username <br><br>
       
        <input type = "text" id="newUsername"> New Username Confirmation <br><br>
        <input type = "text" id="newUsernameConfirmation"> New Username <br><br>
       
    </form>
	  
    <button type="button" class="btn btn-warning navbar-btn" onclick = "changeUsername()"><span class="glyphicon glyphicon-edit"></span> Submit</button>
    <!-- END MATTHEW BEIROUTI ADDITIONS -->
		
	 
  </div><!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->

<div class = "module3">
	
	<form id="addSecurityQuestion" action = >
        <p> Set New Security Question (this will replace previous question): </p>
       
        <select name="securityQuestionList" form="addSecurityQuestion" id="securityQuestion">
  <option value="1">Name of your first pet?</option>
  <option value="2">Name of your favorite childhood teacher?</option>
  <option value="3">Name of your father's highschool?</option>
  <option value="4">Make of your first car?</option>
        <input type="text" id="securityAnswer" >
        
       
       
    </form>
    
</select>
	  
    <button type="button" class="btn btn-warning navbar-btn" onclick = "setSecurityQuestion()"><span class="glyphicon glyphicon-edit"></span> Submit</button>
    <button type="button" class="btn btn-warning navbar-btn" onclick = "removeSecurityQuestion()"><span class="glyphicon glyphicon-edit"></span> Remove Question</button>
    <!-- END MATTHEW BEIROUTI ADDITIONS -->
  
  </div>
         
</div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

    <script type="text/javascript">
        
    <!-- MATTHEW BEIROUTI EDITS -->
        
    function changePassword(){
        
        var formInput = document.getElementById("changePasswordForm");
        
        var oldPasswordSubmitted = formInput.elements[0].value;
        // Get current password from database and place in var
        var oldPasswordDatabase  = " ";
        var newPassword          = formInput.elements[1].value;
        var newPasswordCheck     = formInput.elements[2].value;
        
        console.log(oldPasswordSubmitted, newPassword, newPasswordCheck);
        
        if (newPassword === newPasswordCheck){
             console.log("new passwords match");
             <!-- Change password to newPassword and tell user this was done -->
             <!-- Need to check if password is long enough -->
            
            if(newPassword.length < 8){
                alert("The password entered is not long enough. Please select a password with at least 8 characters");
            } else {  
                $.ajax({
                    type: "POST",
                    url: 'changePassword.php',
                    data: { 
                        password :  oldPasswordSubmitted, 
                        newPassword: newPassword
                    },
                    success: function(data){
                     console.log(data);
                     if(data.trim() == "fail"){
                         alert("The password entered does not match the password associated with your account. Please Try again!");
                     } else {
                         alert("Your password has been changed succesfully!");
                    }
                    }
                });
            }
        } else {
                <!-- Error message of incorrect passwords -->
                alert("The new passwords entered do not match. Please try again!");
        }   
    }
        
        function setSecurityQuestion(){
        
        var formSelectInput = document.getElementById("securityQuestion");
        var formAnswerInput = document.getElementById("securityAnswer");
            
        var question = formSelectInput.value;
        var answer = formAnswerInput.value;
            
        console.log("new security question is '" + question + "' and new answer is '" + answer + "'");
         if(answer.length < 1){
                alert("Please enter an answer to the question.");
            }else{
        
             $.ajax({
                type: "POST",
                url: 'setSecurityQuestion.php',
                 dataType : 'text',
                data: { 
                    question : question, 
                    answer: answer
                },
                success: function(data){
				console.log(data)
                if(data.trim() == "success"){
                    
					alert("Security question has been set successfully!");
				}
                 else if (data.trim() == "exists"){
				 alert("Security question has been changed successfully!");
				 
				 }else{
					alert("Something went wrong! the security question has not been set..");
				 }
                }
            });           
            }
    }
	
    function removeSecurityQuestion(){
        
            
        console.log("Removing security question...");
         
        
             $.ajax({
                type: "POST",
                url: 'removeSecurityQuestion.php',
                 dataType : 'text',
                
                success: function(data){
				console.log(data)
                if(data.trim() == "deleted"){
                    
					alert("Security question has been removed successfully!");
				}
                 else if (data.trim() == "not found"){
				 alert("No security question existed to begin with..");
				 
				 }else{
					alert("Something went wrong! the security question has not been set..");
				 }
                }
            });           
            
    }    
        
        
	 function changeUsername(){
        
        var formInput = document.getElementById("changeUsernameForm");
        
        var oldUsernameSubmitted = formInput.elements[0].value;
        // Get current password from database and place in var
       
        var newUsername          = formInput.elements[1].value;
        var newUsernameCheck     = formInput.elements[2].value;
        
        console.log(oldUsernameSubmitted, newUsername, newUsernameCheck);
        
        if (newUsername === newUsernameCheck){
             console.log("new passwords match");
             <!-- Change username to newUsername and tell user this was done -->
                    
            $.ajax({
                type: "POST",
                url: 'changeUsername.php',
                data: { 
                    username :  oldUsernameSubmitted, 
                    newUsername: newUsername
                },
                success: function(data){
				if(data.trim() == "success"){
					localStorage.currentUser = newUsername;
					alert("Username changed successfully!");
				}
                 else if (data.trim() == "exists"){
				 alert("the username you have entered is already taken!");
				 
				 }else{
					alert("the username you have entered is incorrect");
				 }
                }
            });                  
        } else {
               alert("confirmation username does not match!");
                <!-- Error message of incorrect username -->
        }   
    }
        
        
        
        
    <!-- MATTHEW BEIROUTI EDIT ENDS-->
        
        
        
        
	function signOut(){
		
		$.ajax({
		
			type: "POST",
                url: 'roomrLogout.php',
				
				success: function(data){
						if(data.trim() == "success"){
							window.location.replace("index.php");
							
						}
						else{
							window.alert("Logout failed, please try again");
						}
				
				}
		
		
		});
	
	
	}


    </script>
  


</body>